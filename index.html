
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#0a0a0a">
    <title>FF Tournament Hub Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&family=Russo+One&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Rubik', sans-serif; 
            background-color: #0a0a0a; 
            color: #fff; 
            -webkit-tap-highlight-color: transparent; 
            user-select: none;
            overflow-x: hidden;
        }
        .font-gaming { font-family: 'Russo One', sans-serif; }
        .neon-orange { color: #ff4d00; text-shadow: 0 0 10px rgba(255, 77, 0, 0.5); }
        .bg-neon-orange { background-color: #ff4d00; box-shadow: 0 4px 15px rgba(255, 77, 0, 0.4); }
        ::-webkit-scrollbar { width: 0px; }
        
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(0.98); } }
        .pulse { animation: pulse 2s infinite ease-in-out; }
        input:focus, select:focus, textarea:focus { border-color: #ff4d00 !important; outline: none; }

        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
<script type="importmap">
{
  "imports": {
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo } from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        import htm from 'https://esm.sh/htm@3.1.1';
        import * as Lucide from 'https://esm.sh/lucide-react@0.244.0';

        const html = htm.bind(React.createElement);

        // --- Constants & Config ---
        const APP_NAME = "FF TOURNAMENT HUB";
        const STORAGE_KEY = "ff_hub_user_profile";
        const HISTORY_STORAGE_KEY = "ff_hub_tournament_history";
        const GITHUB_FALLBACK_URL = "https://raw.githubusercontent.com/pawanxumang/pawanxumang.github.io/main/tournaments.json";

        const MOCK_DATA = {
            banners: [
                "https://images.unsplash.com/photo-1542751371-adc38448a05e?auto=format&fit=crop&q=80&w=800",
                "https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&q=80&w=800"
            ],
            rules: [
                "Strictly no hacks or 3rd party tools.",
                "Emulator players are not allowed unless specified.",
                "Must join the room 10 minutes before the start.",
                "Screen recording is recommended for dispute resolution.",
                "Prize will be distributed within 24 hours of match completion."
            ]
        };

        // --- Shared Components ---

        const InputGroup = ({ label, icon, placeholder, value, onChange, error, type = "text" }) => html`
            <div className="flex flex-col gap-1.5 w-full">
                <label className="text-[10px] font-bold text-white/40 uppercase tracking-widest ml-1">${label}</label>
                <div className=${`flex items-center gap-3 bg-[#121212] border ${error ? 'border-red-500' : 'border-white/5'} px-4 py-3 rounded-xl focus-within:border-neon-orange transition-colors shadow-inner`}>
                    <span className="text-white/20">${icon}</span>
                    <input 
                        type=${type}
                        className="bg-transparent border-none outline-none text-sm w-full placeholder:text-white/20 text-white" 
                        placeholder=${placeholder}
                        value=${value}
                        onChange=${(e) => onChange(e.target.value)}
                    />
                </div>
            </div>
        `;

        const ProfileField = ({ label, value, icon, isEditing, onChange }) => html`
            <div className="flex flex-col gap-1">
                <label className="text-[9px] font-bold text-white/30 uppercase tracking-widest ml-1">${label}</label>
                ${isEditing ? html`
                    <div className="flex items-center gap-2 bg-white/5 border border-white/10 rounded-xl px-3 py-2">
                        <span className="text-white/20">${icon}</span>
                        <input 
                            value=${value}
                            onChange=${(e) => onChange(e.target.value)}
                            className="bg-transparent border-none outline-none text-sm w-full text-white"
                        />
                    </div>
                ` : html`
                    <div className="flex items-center gap-2 px-1">
                        <span className="text-neon-orange/60">${icon}</span>
                        <span className="text-sm font-medium text-white/70">${value || 'N/A'}</span>
                    </div>
                `}
            </div>
        `;

        // --- Major Sections ---

        const Onboarding = ({ onSubmit }) => {
            const [formData, setFormData] = useState({ fullName: '', ign: '', uid: '', level: '', device: '', upiId: '' });
            const [errors, setErrors] = useState({});

            const handleSubmit = (e) => {
                e.preventDefault();
                const newErrors = {};
                if (!formData.fullName) newErrors.fullName = 'Required';
                if (!formData.ign) newErrors.ign = 'Required';
                if (!formData.uid) newErrors.uid = 'Required';
                if (!formData.level) newErrors.level = 'Required';
                if (!formData.upiId) newErrors.upiId = 'Required';
                setErrors(newErrors);
                if (Object.keys(newErrors).length === 0) onSubmit(formData);
            };

            return html`
                <div className="min-h-screen bg-[#0a0a0a] flex flex-col items-center px-6 py-12 text-white overflow-y-auto">
                    <div className="w-16 h-16 bg-neon-orange rounded-2xl flex items-center justify-center mb-6 pulse shadow-[0_0_20px_rgba(255,77,0,0.5)]">
                        <span className="font-gaming text-3xl italic">FF</span>
                    </div>
                    <h2 className="font-gaming text-2xl tracking-widest mb-2 text-center uppercase">Join the Elite</h2>
                    <p className="text-white/40 text-sm mb-8 text-center px-4">Create your gaming profile to start participating in tournaments.</p>

                    <form onSubmit=${handleSubmit} className="w-full space-y-4 max-w-sm">
                        <${InputGroup} label="Real Full Name" icon=${html`<${Lucide.User} size=${18}/>`} placeholder="E.g. Pawan Kumar" value=${formData.fullName} onChange=${(v) => setFormData({...formData, fullName: v})} error=${errors.fullName} />
                        <${InputGroup} label="In-Game Name (IGN)" icon=${html`<${Lucide.Shield} size=${18}/>`} placeholder="E.g. HEADSHOT_PRO" value=${formData.ign} onChange=${(v) => setFormData({...formData, ign: v})} error=${errors.ign} />
                        <${InputGroup} label="Free Fire UID" icon=${html`<${Lucide.Smartphone} size=${18}/>`} placeholder="E.g. 123456789" value=${formData.uid} onChange=${(v) => setFormData({...formData, uid: v})} error=${errors.uid} />
                        <div className="grid grid-cols-2 gap-4">
                            <${InputGroup} label="Level" icon=${html`<${Lucide.Award} size=${18}/>`} placeholder="65" value=${formData.level} onChange=${(v) => setFormData({...formData, level: v})} error=${errors.level} />
                            <${InputGroup} label="Device" icon=${html`<${Lucide.Smartphone} size=${18}/>`} placeholder="iPhone" value=${formData.device} onChange=${(v) => setFormData({...formData, device: v})} />
                        </div>
                        <${InputGroup} label="Your UPI ID" icon=${html`<${Lucide.CreditCard} size=${18}/>`} placeholder="username@upi" value=${formData.upiId} onChange=${(v) => setFormData({...formData, upiId: v})} error=${errors.upiId} />

                        <button type="submit" className="w-full bg-neon-orange py-4 rounded-xl font-gaming text-white tracking-widest mt-6 hover:brightness-110 active:scale-95 transition-all flex items-center justify-center gap-2">
                            <${Lucide.UserPlus} size=${20} /> CREATE PROFILE
                        </button>
                    </form>
                </div>
            `;
        };

        const Home = ({ tournaments, banners, onSelectTournament }) => {
            const [currentBanner, setCurrentBanner] = useState(0);

            useEffect(() => {
                if (banners.length > 0) {
                    const timer = setInterval(() => setCurrentBanner((prev) => (prev + 1) % banners.length), 4000);
                    return () => clearInterval(timer);
                }
            }, [banners.length]);

            return html`
                <div className="flex flex-col gap-6 p-4 animate-in fade-in duration-500">
                    <div className="relative w-full h-44 rounded-2xl overflow-hidden group shadow-[0_8px_20px_rgba(0,0,0,0.5)] border border-white/5">
                        ${banners.map((banner, idx) => html`
                            <img 
                                key=${idx}
                                src=${banner} 
                                className=${`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ease-in-out ${idx === currentBanner ? 'opacity-100' : 'opacity-0'}`}
                            />
                        `)}
                        <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent flex flex-col justify-end p-4">
                            <p className="font-gaming text-xs text-neon-orange tracking-widest italic drop-shadow-lg uppercase">Featured Event</p>
                            <h3 className="font-gaming text-xl text-white drop-shadow-md">PRO SERIES CHAMPIONS</h3>
                        </div>
                    </div>

                    <div className="flex flex-col gap-4">
                        <div className="flex items-center justify-between px-1">
                            <h2 className="font-gaming text-sm tracking-widest text-white/80 uppercase">Live Matches</h2>
                            <span className="text-[10px] text-neon-orange font-bold uppercase tracking-widest bg-neon-orange/10 px-2 py-0.5 rounded border border-neon-orange/20">Open</span>
                        </div>
                        <div className="grid gap-4">
                            ${tournaments.map(t => html`
                                <div 
                                    key=${t.id}
                                    onClick=${() => onSelectTournament(t)}
                                    className="bg-[#121212] rounded-2xl overflow-hidden border border-white/5 hover:border-white/10 active:scale-[0.98] transition-all group cursor-pointer"
                                >
                                    <div className="relative h-32">
                                        <img src=${t.image} className="w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-500" />
                                        <div className="absolute inset-0 bg-gradient-to-t from-[#121212] via-transparent to-transparent"></div>
                                        <div className="absolute top-3 left-3 flex gap-2">
                                            <span className=${`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-widest border ${t.status === 'Open' ? 'bg-green-500/10 text-green-500 border-green-500/20' : 'bg-red-500/10 text-red-500 border-red-500/20'}`}>${t.status}</span>
                                            <span className="text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-widest bg-neon-orange/20 text-white border border-neon-orange/30">₹${t.entryFee} Entry</span>
                                        </div>
                                        <div className="absolute bottom-2 left-3">
                                            <h3 className="font-gaming text-lg text-white leading-none mb-1 drop-shadow-md">${t.name}</h3>
                                        </div>
                                    </div>
                                    <div className="p-4 flex flex-col gap-4">
                                        <div className="grid grid-cols-3 gap-2">
                                            <div className="flex flex-col items-center gap-1"><${Lucide.Users} size=${14} className="text-neon-orange"/><span className="text-[10px] text-white/40 font-bold uppercase tracking-wider">Type</span><span className="text-xs font-gaming">${t.matchType}</span></div>
                                            <div className="flex flex-col items-center gap-1 border-x border-white/5"><${Lucide.Trophy} size=${14} className="text-neon-orange"/><span className="text-[10px] text-white/40 font-bold uppercase tracking-wider">Prize</span><span className="text-xs font-gaming text-yellow-400">${t.prizePool}</span></div>
                                            <div className="flex flex-col items-center gap-1"><${Lucide.Calendar} size=${14} className="text-neon-orange"/><span className="text-[10px] text-white/40 font-bold uppercase tracking-wider">Time</span><span className="text-[10px] font-bold whitespace-nowrap">${t.dateTime.split(',')[1] || t.dateTime}</span></div>
                                        </div>
                                        <div className="h-1.5 w-full bg-white/5 rounded-full overflow-hidden">
                                            <div className="h-full bg-neon-orange" style=${{ width: `${(t.joinedSlots/t.totalSlots)*100}%` }}></div>
                                        </div>
                                        <button className="w-full bg-white/5 group-hover:bg-neon-orange transition-colors py-2 rounded-lg flex items-center justify-center gap-2 group">
                                            <span className="font-gaming text-[10px] tracking-widest group-hover:text-white text-white/40 uppercase">View Tournament</span>
                                            <${Lucide.ChevronRight} size=${14} className="group-hover:translate-x-1 transition-transform" />
                                        </button>
                                    </div>
                                </div>
                            `)}
                        </div>
                    </div>
                </div>
            `;
        };

        const TournamentDetail = ({ tournament, user, onClose, onJoinSuccess, upiId, adminWhatsApp }) => {
            const [step, setStep] = useState('details');

            const handleWhatsAppRedirect = () => {
                const message = encodeURIComponent(`Hi Admin! I want to confirm my slot for ${tournament.name}.\n\n*PLAYER:* ${user.ign}\n*UID:* ${user.uid}\n*FEE:* ₹${tournament.entryFee}\n\nPayment screenshot attached.`);
                onJoinSuccess();
                window.open(`https://wa.me/${adminWhatsApp}?text=${message}`, '_blank');
            };

            const upiUrl = `upi://pay?pa=${upiId}&pn=FFTournamentHub&am=${tournament.entryFee}&cu=INR&tn=${encodeURIComponent(tournament.name)}`;
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(upiUrl)}`;

            return html`
                <div className="fixed inset-0 z-[100] flex items-end justify-center animate-in slide-in-from-bottom duration-300">
                    <div className="absolute inset-0 bg-black/80 backdrop-blur-sm" onClick=${onClose}></div>
                    <div className="relative w-full max-w-md bg-[#0a0a0a] rounded-t-[32px] border-t border-white/10 shadow-2xl flex flex-col max-h-[92vh] overflow-hidden">
                        <div className="relative h-48 flex-shrink-0">
                            <img src=${tournament.image} className="w-full h-full object-cover opacity-50" />
                            <div className="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] to-transparent"></div>
                            <button onClick=${onClose} className="absolute top-6 right-6 p-2 bg-black/40 rounded-full text-white/80"><${Lucide.X} size=${20} /></button>
                            <div className="absolute bottom-6 left-8">
                                <h2 className="font-gaming text-2xl text-white uppercase">${tournament.name}</h2>
                                <p className="text-neon-orange font-bold text-xs">${tournament.matchType} • ₹${tournament.entryFee}</p>
                            </div>
                        </div>
                        <div className="flex-1 overflow-y-auto px-8 py-4 space-y-6">
                            ${step === 'details' && html`
                                <div className="space-y-6">
                                    <div className="grid grid-cols-3 gap-4 text-center">
                                        <div className="p-3 rounded-2xl bg-[#121212] border border-white/5 flex flex-col items-center"><${Lucide.Users} size=${18} className="text-neon-orange"/><span className="text-[10px] font-bold text-white/30 uppercase mt-1">Type</span><span className="text-[11px] font-gaming">${tournament.matchType}</span></div>
                                        <div className="p-3 rounded-2xl bg-[#121212] border border-white/5 flex flex-col items-center"><${Lucide.Calendar} size=${18} className="text-neon-orange"/><span className="text-[10px] font-bold text-white/30 uppercase mt-1">Date</span><span className="text-[11px] font-gaming">${tournament.dateTime.split(',')[0]}</span></div>
                                        <div className="p-3 rounded-2xl bg-[#121212] border border-white/5 flex flex-col items-center"><${Lucide.Trophy} size=${18} className="text-neon-orange"/><span className="text-[10px] font-bold text-white/30 uppercase mt-1">Prize</span><span className="text-[11px] font-gaming">${tournament.prizePool}</span></div>
                                    </div>
                                    <div className="space-y-3">
                                        <h3 className="font-gaming text-xs text-white/40 uppercase">Match Rules</h3>
                                        <ul className="space-y-2 pb-4">
                                            ${tournament.rules.map((rule, i) => html`<li key=${i} className="flex gap-3 text-sm text-white/50"><span className="text-neon-orange">•</span>${rule}</li>`)}
                                        </ul>
                                    </div>
                                </div>
                            `}
                            ${step === 'payment' && html`
                                <div className="space-y-6 text-center flex flex-col items-center py-4">
                                    <div className="bg-white p-4 rounded-2xl shadow-xl"><img src=${qrCodeUrl} className="w-48 h-48" /></div>
                                    <h3 className="font-gaming text-lg text-white uppercase tracking-wider">Pay ₹${tournament.entryFee}</h3>
                                    <p className="text-white/40 text-xs uppercase flex items-center gap-2"><${Lucide.CreditCard} size=${14} className="text-neon-orange" /> Scan to pay via Any UPI App</p>
                                    <a href=${upiUrl} className="text-neon-orange text-[10px] font-bold uppercase underline">Open UPI App Directly</a>
                                </div>
                            `}
                        </div>
                        <div className="p-8 bg-[#0a0a0a]">
                            ${step === 'details' ? html`<button onClick=${() => setStep('payment')} className="w-full bg-neon-orange py-4 rounded-xl font-gaming text-white uppercase shadow-lg">Proceed to Register</button>` : 
                            html`<button onClick=${handleWhatsAppRedirect} className="w-full bg-[#25D366] py-4 rounded-xl font-gaming text-white uppercase flex items-center justify-center gap-2 shadow-lg"><${Lucide.MessageSquare} size=${20} /> Confirm Payment</button>`}
                        </div>
                    </div>
                </div>
            `;
        };

        const ProfileView = ({ user, onUpdate, onAdminOpen }) => {
            const [isEditing, setIsEditing] = useState(false);
            const [formData, setFormData] = useState(user);

            const handleSubmit = (e) => {
                e.preventDefault();
                onUpdate(formData);
                setIsEditing(false);
            };

            return html`
                <div className="p-6 animate-in fade-in duration-500 flex flex-col gap-6">
                    <div className="flex items-center justify-between">
                        <h2 className="font-gaming text-lg tracking-widest text-white/80 uppercase">My Profile</h2>
                        <button onClick=${() => setIsEditing(!isEditing)} className="p-2 bg-white/5 rounded-full text-neon-orange"><${Lucide.Edit2} size={18} /></button>
                    </div>
                    <form onSubmit=${handleSubmit} className="bg-[#121212] rounded-3xl p-6 border border-white/5 shadow-xl space-y-6">
                        <div className="flex items-center gap-4">
                            <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-neon-orange to-orange-700 flex items-center justify-center font-gaming text-2xl">${user.ign.charAt(0).toUpperCase()}</div>
                            <div><h3 className="font-gaming text-xl text-white">${user.ign}</h3><p className="text-white/40 text-xs uppercase tracking-widest">Level ${user.level}</p></div>
                        </div>
                        <div className="grid gap-4">
                            <${ProfileField} label="Full Name" value=${formData.fullName} icon=${html`<${Lucide.User} size=${14}/>`} isEditing=${isEditing} onChange=${(v) => setFormData({...formData, fullName: v})} />
                            <${ProfileField} label="FF UID" value=${formData.uid} icon=${html`<${Lucide.Smartphone} size=${14}/>`} isEditing=${isEditing} onChange=${(v) => setFormData({...formData, uid: v})} />
                            <${ProfileField} label="UPI ID" value=${formData.upiId} icon=${html`<${Lucide.CreditCard} size=${14}/>`} isEditing=${isEditing} onChange=${(v) => setFormData({...formData, upiId: v})} />
                        </div>
                        ${isEditing && html`<button type="submit" className="w-full bg-neon-orange py-4 rounded-xl font-gaming text-white uppercase shadow-lg">Save Profile</button>`}
                    </form>
                    <button onClick=${onAdminOpen} className="flex items-center justify-between bg-white/5 border border-white/5 rounded-2xl p-4 group">
                        <div className="flex items-center gap-3">
                            <div className="p-2 bg-neon-orange/10 rounded-lg text-neon-orange"><${Lucide.Settings} size=${20} /></div>
                            <div className="text-left"><h4 className="text-xs font-gaming text-white uppercase">Admin Console</h4><p className="text-[10px] text-white/30 uppercase tracking-widest font-bold">Manage Matches</p></div>
                        </div>
                        <${Lucide.ChevronRight} size=${16} className="text-white/20" />
                    </button>
                    <button onClick=${() => { localStorage.clear(); window.location.reload(); }} className="text-xs text-white/20 uppercase font-bold tracking-widest hover:text-red-500 text-center">Reset App Data</button>
                </div>
            `;
        };

        const AdminPanel = ({ config, tournaments, onClose }) => {
            const [localTournaments, setLocalTournaments] = useState(tournaments);
            const [showJson, setShowJson] = useState(false);
            const [copied, setCopied] = useState(false);

            const updateTournament = (id, updates) => setLocalTournaments(prev => prev.map(t => t.id === id ? { ...t, ...updates } : t));
            const addTournament = () => {
                const newT = { id: Date.now().toString(), name: "New Match", matchType: "Solo", entryFee: 50, dateTime: "Coming Soon", prizePool: "₹1000", status: "Open", image: MOCK_DATA.banners[0], description: "Match details...", rules: MOCK_DATA.rules, totalSlots: 48, joinedSlots: 0 };
                setLocalTournaments([newT, ...localTournaments]);
            };

            const outputJson = JSON.stringify({ ...config, tournaments: localTournaments }, null, 2);
            const copyJson = () => { navigator.clipboard.writeText(outputJson); setCopied(true); setTimeout(() => setCopied(false), 2000); };

            return html`
                <div className="fixed inset-0 z-[200] bg-[#0a0a0a] flex flex-col text-white animate-in fade-in">
                    <header className="px-6 py-4 bg-[#121212] border-b border-white/5 flex items-center justify-between sticky top-0 z-10 shadow-xl">
                        <div className="flex items-center gap-3"><${Lucide.Settings} className="text-neon-orange" size=${20} /><h2 className="font-gaming text-sm tracking-widest uppercase text-white">ADMIN CONSOLE</h2></div>
                        <button onClick=${onClose} className="p-2 bg-white/5 rounded-full"><${Lucide.X} size=${20} /></button>
                    </header>
                    <main className="flex-1 overflow-y-auto p-4 space-y-6 pb-24">
                        <div className="flex justify-between items-center px-2">
                            <h3 className="font-gaming text-[10px] text-white/30 tracking-widest uppercase">Match List</h3>
                            <button onClick=${addTournament} className="bg-neon-orange px-4 py-2 rounded-xl text-[10px] font-bold uppercase shadow-lg shadow-neon-orange/20"><${Lucide.Plus} size=${16} /></button>
                        </div>
                        ${localTournaments.map(t => html`
                            <div key=${t.id} className="bg-[#121212] rounded-2xl border border-white/5 p-5 space-y-4">
                                <div className="flex justify-between"><input className="bg-transparent border-b border-white/10 outline-none text-white font-gaming uppercase text-sm w-full" value=${t.name} onChange=${(e) => updateTournament(t.id, {name: e.target.value})} /><button onClick=${() => setLocalTournaments(prev => prev.filter(x => x.id !== t.id))} className="text-red-500/40 ml-4"><${Lucide.Trash2} size=${18} /></button></div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="flex flex-col gap-1"><span className="text-[9px] text-white/20 uppercase font-bold">Fee</span><input className="bg-black/40 border border-white/5 rounded px-2 py-1 text-xs" value=${t.entryFee} onChange=${(e) => updateTournament(t.id, {entryFee: parseInt(e.target.value)||0})} /></div>
                                    <div className="flex flex-col gap-1"><span className="text-[9px] text-white/20 uppercase font-bold">Prize</span><input className="bg-black/40 border border-white/5 rounded px-2 py-1 text-xs" value=${t.prizePool} onChange=${(e) => updateTournament(t.id, {prizePool: e.target.value})} /></div>
                                </div>
                            </div>
                        `)}
                    </main>
                    <footer className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-[#121212] border-t border-white/10 p-5 z-20"><button onClick=${() => setShowJson(true)} className="w-full bg-neon-orange py-4 rounded-2xl font-gaming text-sm tracking-widest shadow-xl shadow-neon-orange/30">SYNC UPDATES</button></footer>
                    ${showJson && html`
                        <div className="fixed inset-0 z-[300] bg-black/95 flex items-center justify-center p-6 backdrop-blur-md animate-in fade-in">
                            <div className="bg-[#121212] w-full max-w-sm rounded-[32px] border border-white/10 overflow-hidden flex flex-col max-h-[85vh] shadow-2xl">
                                <div className="p-6 border-b border-white/5 flex justify-between items-center bg-white/5">
                                    <h3 className="font-gaming text-sm text-white">UPDATE GITHUB</h3>
                                    <button onClick=${() => setShowJson(false)} className="p-2 bg-white/5 rounded-full"><${Lucide.X} size=${18}/></button>
                                </div>
                                <div className="p-6 space-y-6 overflow-y-auto">
                                    <button onClick=${copyJson} className=${`w-full py-4 rounded-2xl flex items-center justify-center gap-2 text-xs font-bold transition-all ${copied ? 'bg-green-500' : 'bg-white/10'}`}>${copied ? html`<${Lucide.Check} size=${18}/>` : html`<${Lucide.Copy} size=${18}/>`} ${copied ? "COPIED" : "COPY CODE"}</button>
                                    <p className="text-[10px] text-white/30 leading-relaxed text-center">Open <span className="text-white/60 font-mono">tournaments.json</span> on GitHub and paste this code.</p>
                                    <pre className="text-[8px] text-white/20 font-mono bg-black/40 p-4 rounded-xl overflow-x-auto whitespace-pre h-32">${outputJson}</pre>
                                </div>
                            </div>
                        </div>
                    `}
                </div>
            `;
        };

        // --- Root App ---

        const App = () => {
            const [user, setUser] = useState(null);
            const [tournaments, setTournaments] = useState([]);
            const [joinedHistory, setJoinedHistory] = useState([]);
            const [activeTab, setActiveTab] = useState('home');
            const [selectedTournament, setSelectedTournament] = useState(null);
            const [isAdminOpen, setIsAdminOpen] = useState(false);
            const [isAdminLoginOpen, setIsAdminLoginOpen] = useState(false);
            const [adminPassInput, setAdminPassInput] = useState('');
            const [isLoading, setIsLoading] = useState(true);
            const [config, setConfig] = useState({ banners: MOCK_DATA.banners, rules: MOCK_DATA.rules, upiId: "pawanponnam-1@okicici", adminWhatsApp: "919867637326" });

            useEffect(() => {
                const savedProfile = localStorage.getItem(STORAGE_KEY);
                if (savedProfile) setUser(JSON.parse(savedProfile));

                const savedHistory = localStorage.getItem(HISTORY_STORAGE_KEY);
                if (savedHistory) setJoinedHistory(JSON.parse(savedHistory));

                const fetchTournaments = async () => {
                    setIsLoading(true);
                    try {
                        const response = await fetch(GITHUB_FALLBACK_URL + '?t=' + Date.now());
                        if (response.ok) {
                            const data = await response.json();
                            setTournaments(data.tournaments || []);
                            setConfig({ banners: data.banners || MOCK_DATA.banners, rules: data.rules || MOCK_DATA.rules, upiId: data.upiId || "pawanponnam-1@okicici", adminWhatsApp: data.adminWhatsApp || "919867637326" });
                        }
                    } catch (e) {
                        setTournaments([{ id: '1', name: 'Elite Solo Cup', matchType: 'Solo', entryFee: 50, dateTime: 'Coming Soon', prizePool: '₹1000', status: 'Open', image: MOCK_DATA.banners[0], rules: MOCK_DATA.rules, totalSlots: 48, joinedSlots: 10 }]);
                    }
                    setIsLoading(false);
                };
                fetchTournaments();
            }, []);

            const handleAdminLogin = (e) => {
                e.preventDefault();
                if (adminPassInput === "Pawan1645@") { setIsAdminOpen(true); setIsAdminLoginOpen(false); setAdminPassInput(''); }
                else alert("Invalid Access Code!");
            };

            if (!user) return html`<${Onboarding} onSubmit=${(p) => { setUser(p); localStorage.setItem(STORAGE_KEY, JSON.stringify(p)); }} />`;

            return html`
                <div className="flex flex-col h-screen max-w-md mx-auto bg-[#0a0a0a] overflow-hidden relative">
                    <header className="px-5 py-4 bg-[#121212] border-b border-white/5 flex items-center justify-between sticky top-0 z-40 shadow-xl">
                        <div className="flex items-center gap-2"><div className="w-8 h-8 bg-neon-orange rounded-md flex items-center justify-center"><span className="text-white font-gaming text-sm italic">FF</span></div><h1 className="font-gaming text-lg tracking-wider neon-orange">${APP_NAME}</h1></div>
                        <div className="flex items-center gap-2">
                            <a href="https://youtube.com/@shinzofreefire" className="p-2 text-white/40"><${Lucide.Youtube} size=${22}/></a>
                            <button onClick=${() => setIsAdminLoginOpen(true)} className="p-2 text-white/40"><${Lucide.Lock} size=${18}/></button>
                        </div>
                    </header>

                    <main className="flex-1 overflow-y-auto pb-24">
                        ${isLoading ? html`<div className="flex flex-col items-center justify-center h-64 gap-4"><div className="w-10 h-10 border-2 border-neon-orange border-t-transparent rounded-full animate-spin"></div><p className="font-gaming text-[10px] tracking-widest text-white/20">LOADING ARENA...</p></div>` : 
                        html`
                            ${activeTab === 'home' && html`<${Home} tournaments=${tournaments} banners=${config.banners} onSelectTournament=${setSelectedTournament} />`}
                            ${activeTab === 'rules' && html`
                                <div className="p-6 animate-in fade-in duration-500 space-y-6">
                                    <div className="flex items-center gap-3"><div className="w-10 h-10 bg-neon-orange/10 rounded-xl flex items-center justify-center text-neon-orange"><${Lucide.ScrollText} size=${20} /></div><h2 className="font-gaming text-lg tracking-widest uppercase">Match Rules</h2></div>
                                    <div className="bg-[#121212] rounded-2xl p-6 border border-white/5 space-y-6">
                                        ${config.rules.map((r, i) => html`<div key=${i} className="flex gap-4 group"><span className="font-gaming text-xs text-neon-orange/30">0${i+1}</span><p className="text-sm text-white/60 leading-relaxed">${r}</p></div>`)}
                                    </div>
                                </div>
                            `}
                            ${activeTab === 'profile' && html`<${ProfileView} user=${user} onUpdate=${(p) => {setUser(p); localStorage.setItem(STORAGE_KEY, JSON.stringify(p));}} onAdminOpen=${() => setIsAdminLoginOpen(true)} />`}
                        `}
                    </main>

                    <nav className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-[#121212] border-t border-white/5 flex justify-around items-center h-16 z-40">
                        <button onClick=${() => setActiveTab('home')} className=${`flex flex-col items-center gap-1 ${activeTab === 'home' ? 'text-neon-orange' : 'text-white/40'}`}><${Lucide.Home} size=${22}/><span className="text-[9px] font-bold uppercase">Lobby</span></button>
                        <button onClick=${() => setActiveTab('rules')} className=${`flex flex-col items-center gap-1 ${activeTab === 'rules' ? 'text-neon-orange' : 'text-white/40'}`}><${Lucide.ScrollText} size=${22}/><span className="text-[9px] font-bold uppercase">Rules</span></button>
                        <button onClick=${() => setActiveTab('profile')} className=${`flex flex-col items-center gap-1 ${activeTab === 'profile' ? 'text-neon-orange' : 'text-white/40'}`}><${Lucide.User} size=${22}/><span className="text-[9px] font-bold uppercase">Profile</span></button>
                    </nav>

                    ${isAdminLoginOpen && html`
                        <div className="fixed inset-0 z-[150] bg-black/95 backdrop-blur-xl flex items-center justify-center p-8 animate-in fade-in">
                            <div className="bg-[#121212] w-full max-w-xs rounded-[40px] border border-white/10 p-10 flex flex-col items-center gap-6 shadow-2xl relative">
                                <button onClick=${() => setIsAdminLoginOpen(false)} className="absolute top-6 right-6 p-2 bg-white/5 rounded-full"><${Lucide.X} size=${18}/></button>
                                <div className="w-16 h-16 bg-neon-orange/10 rounded-3xl flex items-center justify-center text-neon-orange shadow-lg shadow-neon-orange/10"><${Lucide.Lock} size=${32} /></div>
                                <div className="text-center"><h3 className="font-gaming text-xl text-white uppercase">Admin Login</h3><p className="text-[10px] text-white/30 tracking-widest uppercase font-bold mt-1">Authorized Access</p></div>
                                <form onSubmit=${handleAdminLogin} className="w-full space-y-4">
                                    <input type="password" placeholder="Passcode" className="w-full bg-black/60 border border-white/10 rounded-2xl px-4 py-4 text-center tracking-[0.5em] text-white focus:border-neon-orange outline-none" value=${adminPassInput} onChange=${(e) => setAdminPassInput(e.target.value)} autoFocus />
                                    <button type="submit" className="w-full bg-neon-orange py-4 rounded-2xl font-gaming text-xs tracking-widest text-white shadow-xl shadow-neon-orange/30 active:scale-95 transition-all uppercase">Enter Arena</button>
                                </form>
                            </div>
                        </div>
                    `}

                    ${selectedTournament && html`<${TournamentDetail} tournament=${selectedTournament} user=${user} onClose=${() => setSelectedTournament(null)} onJoinSuccess=${() => {}} upiId=${config.upiId} adminWhatsApp=${config.adminWhatsApp} />`}
                    ${isAdminOpen && html`<${AdminPanel} config=${config} tournaments=${tournaments} onClose=${() => setIsAdminOpen(false)} />`}
                </div>
            `;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
